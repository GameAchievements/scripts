(()=>{async function b(t,r,a,o){if($(`${t}-btn-guide-edit`).hide(),!r)return;let e=await fetch(`https://${a}/api/achievement/${o}/guide-auth-user-data`,{headers:{Authorization:`Bearer ${r}`}});if(e.status!==200)return;let c=await e.json();c?.ownedGuideId>0&&($(`${t}-btn-guide-create`).hide(),$(`${t}-btn-guide-edit`).attr("href",`/guide-form?id=${c.ownedGuideId}`).show())}var v=t=>{let r=new Date(t),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=`${r.getDate()} ${a[r.getMonth()]}, ${r.getFullYear()}`,e=r.toLocaleTimeString().toLowerCase();return{date:o,time:e}};var T=t=>t?.length?t.replace(/"(\w)/g,"\u201C$1").replace(/(\w)"/g,"$1\u201D").replaceAll('"',"'"):t;var L=t=>{if(t<25)return"common";if(t<50)return"rare";if(t<75)return"very-rare";if(t>=75)return"ultra-rare"},C=(t,r,a=".hero-section-achievement")=>{let o=r,e=L(t);return o=$(".rarity-tag-wrapper",o).children(`:not(.gas-rarity-tag-${e})`).hide().parents(a).prop("outerHTML"),o};var A=(t,r,a=".gas-list-entry")=>{let o=r,e={ps:{rgx:/playstation/gi},xbox:{rgx:/xbox/gi},steam:{rgx:/steam|pc|windows|mac|linux/gi}};return e.ps.rgx.test(t)&&(o=$(".gas-platform-psn",o).css("display","inherit").parents(a).prop("outerHTML")),e.steam.rgx.test(t)&&(o=$(".gas-platform-steam",o).css("display","inherit").parents(a).prop("outerHTML")),e.xbox.rgx.test(t)&&(o=$(".gas-platform-xbox",o).css("display","inherit").parents(a).prop("outerHTML")),o};var u=(t,r,a=".gas-list-entry")=>t.removeAttr("srcset").removeAttr("sizes").attr("src",r).parents(a).prop("outerHTML");function I({listsData:t,listResultsKey:r,elemId:a,textKeysToReplace:o}){console.info(`=== ${a} results ===`,t);let e=$(a),c=e.prop("outerHTML"),i=$(".gas-list-empty",e),p=e.children().first(),n=$(".gas-list-entry",e).first();e.html(p);let l=t[r];l?.length>0?(n.show(),e.append(n),c=n.prop("outerHTML"),n.hide(),l.forEach((h,f)=>{let s=c;for(let[m,d]of Object.entries(h)){let g=$(".gas-list-entry-cover",s);if(g?.length&&h.iconURL?.length&&(s=u(g,h.iconURL)||s),s=s.replaceAll("{|idx|}",f+1),m==="unlockedAt"){let{date:R,time:S}=v(d);s=s.replaceAll("{|unlockedDt|}",R||"N.A."),s=s.replaceAll(`{|${m}|}`,S||"N.A.")}else o.includes(m)&&(s=s.replaceAll(`{|${m}|}`,d||""))}e.append(s).children().last().removeClass(["bg-light","bg-dark"]).addClass(`bg-${f%2>0?"light":"dark"}`)})):(e.append(i),i.show()),e.show()}async function M({elemIdPrefix:t,apiDomain:r,achievementId:a},{listName:o,type:e,textKeysToReplace:c}){let i=`${t}-${o}-${e==="last"?"latest":e}`,n=await(await fetch(`https://${r}/api/achievement/${a}/${o}?type=${e}`)).json();I({listsData:n,listResultsKey:o,elemId:i,textKeysToReplace:c})}async function H(t,r,a){await M({elemIdPrefix:t,apiDomain:r,achievementId:a},{listName:"achievers",type:"first",textKeysToReplace:["name","profileId"]}),await M({elemIdPrefix:t,apiDomain:r,achievementId:a},{listName:"achievers",type:"last",textKeysToReplace:["name","profileId"]})}function j({listData:t,listResultsKey:r,elemId:a,numKeysToReplace:o,textKeysToReplace:e}){console.info(`=== ${a} results ===`,t);let c=$(a).prop("outerHTML"),i=$(`${a} .gas-list`),p=$(".gas-list-empty",i);if(t.count>0&&t[r]?.length){let n=i.children().first(),l=$(".gas-list-entry",i).first();l.show(),c=l.prop("outerHTML"),i.html(n).append(l),l.hide(),t[r].forEach((h,f)=>{let s=c;for(let[m,d]of Object.entries(h)){let g=$(".gas-list-entry-cover",s);g?.length&&h.iconURL?.length&&(s=u(g,h.iconURL)||s),e.includes(m)?s=s.replaceAll(`{|${m}|}`,T(d)||""):o.includes(m)&&(s=s.replaceAll(`{|${m}|}`,Math.round(d||0)))}i.append(s).children().last().removeClass(["bg-light","bg-dark"]).addClass(`bg-${f%2>0?"light":"dark"}`)})}else i.html(p),p.show();i.css("display","flex")}async function O({elemIdPrefix:t,apiDomain:r,achievementId:a},{listName:o,numKeysToReplace:e,textKeysToReplace:c}){let i=`${t}-${o}`,n=await(await fetch(`https://${r}/api/achievement/${a}/${o}`)).json();j({listData:n,listResultsKey:o,elemId:i,numKeysToReplace:e,textKeysToReplace:c})}async function k(t,r,a){await O({elemIdPrefix:t,apiDomain:r,achievementId:a},{listName:"guides",numKeysToReplace:["id","commentsCount","viewsCount","likesCount"],textKeysToReplace:["profileId","name","description","author"]})}function V(t,r){let a=`${t}-details`,o=$(a),e=o.prop("outerHTML");console.info(`=== ${a} ===`,r);let c=["id","name","description","gameId","gameName"],i=["achievers","completionPercentage","guides","gaPoints"],p=r.coverURL||r.imageURL||r.gameImageURL;p?.length&&(e=o.css("background-image",`linear-gradient(rgba(255,255,255,0),#030922),
          linear-gradient(rgba(70,89,255,.4),rgba(70,89,255,.4)),
          url(${p})`).prop("outerHTML")),$(".achievement-main-img",e).each((n,l)=>{r.imageURL?.length&&(e=u($(l),r.imageURL,a)||e)});for(let[n,l]of Object.entries(r))c.includes(n)?e=e.replaceAll(`{|${n}|}`,l):i.includes(n)?e=e.replaceAll(`{|${n}|}`,Math.round(l||0)):n==="platform"?e=A(l,e,a):n==="rarity"&&(e=C(l,e));o.prop("outerHTML",e)}async function F(t,r,a){let o=await fetch(`https://${r}/api/achievement/${a}`);if(o.status!==200)return;let e=await o.json();return Object.keys(e).length>0&&e.id&&(document.title=`${e.name?.length?e.name:e.id} | ${document.title}`,V(t,e)),e}var w=document.querySelector("meta[name=domain]")?.content,G=new URLSearchParams(window.location.search),x=G.get("id")||1044,y="#gas-achievement";$(".ga-loader-container").show();$("#ga-sections-container").hide();$().ready(async()=>{if(await auth0Bootstrap(),await b(y,token,w,x),await F(y,w,x)){await Promise.all([await k(y,w,x),await H(y,w,x)]),$(".ga-loader-container").hide(),$("#ga-sections-container").show(),$("#gas-wf-tab-activator").click();return}window.location.replace("/achievements")});})();
