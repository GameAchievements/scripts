(()=>{var b=document.querySelector("meta[name=domain]")?.content,o="#gas-management-igdb-form",r=4e3,g=t=>{let a=$(".submit-button",o);if(!$(t).val()?.length)$(t).prev("label").addClass("field-label-missing"),a.addClass("disabled-button").attr("disabled",!0);else{$(t).prev("label").removeClass("field-label-missing");let s=!0;$(t).siblings("input").each((l,e)=>{$(e).val().length||(s=!1)}),s&&a.removeClass("disabled-button").attr("disabled",!1)}},f=()=>{let t=$(".submit-button",o);t.attr("disabled",!0);let a=$("[name=game]",o),s=$("[name=igdb]",o),l=t.text(),e=$(".gas-form-error",o),n=$("div",e),c=e.text(),d=$(".gas-form-success",o);a.on("focusout keyup",i=>g(i.target)),s.on("focusout keyup",i=>g(i.target)),t.on("click",async i=>{if(i.preventDefault(),!a.val().length||!s.val().length){e.show(),n.text("Please add both numeric IDs above"),setTimeout(()=>{e.hide(),n.text(c)},r);return}isUserInputActive=!1,t.text(t.data("wait"));let m=await fetch(`https://${b}/api/game/igdb-link-to-game`,{method:"PUT",headers:{Authorization:`Bearer ${token}`,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({igdbId:s.val(),gameId:a.val()})}),u=await m.json();if(m.status!==201){e.show(),n.text(u?.message),setTimeout(()=>{e.hide(),n.text(c),t.text(l)},r*2);return}d.attr("title",u?.message).show(),setTimeout(()=>{d.hide()},r)})};$(async()=>{if(await auth0Bootstrap(),userProfileData?.role?.toLowerCase()!=="manager"){location.replace("/");return}f()});})();
