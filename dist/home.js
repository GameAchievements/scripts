(()=>{var g=e=>{let a=s=>`0${s}`.slice(-2),t=new Date(e);return`${t.getFullYear()} . ${a(t.getMonth()+1)} . ${a(t.getDate())}`};var v=e=>e?.length?e.replace(/"(\w)/g,"\u201C$1").replace(/(\w)"/g,"$1\u201D").replaceAll('"',"'"):e;function C(e,a){if(e.length<=a)return e;let t=e.substr(0,a);return t=t.substr(0,Math.min(t.length,t.lastIndexOf(" "))),`${t} ...`}var f=e=>e?.includes("steamstatic")||e?.includes("steampowered"),T=e=>e?.includes("images-eds.xboxlive.com");var x=(e,a,t=".gas-list-entry")=>{let s=a,r={ps:{rgx:/playstation/gi},xbox:{rgx:/xbox/gi},steam:{rgx:/steam|pc|windows|mac|linux/gi}};return r.ps.rgx.test(e)&&(s=$(".gas-platform-psn",s).css("display","inherit").parents(t).prop("outerHTML")),r.steam.rgx.test(e)&&(s=$(".gas-platform-steam",s).css("display","inherit").parents(t).prop("outerHTML")),r.xbox.rgx.test(e)&&(s=$(".gas-platform-xbox",s).css("display","inherit").parents(t).prop("outerHTML")),s};var w=(e,a,t=".gas-list-entry")=>e.removeAttr("srcset").removeAttr("sizes").attr("src",a).parents(t).prop("outerHTML");function V(e){switch(e){case 1:return"#FF6C6C";case 2:return"#FF876C";case 3:return"#FFB36C";case 4:return"#FFD66C";case 5:return"#D0FF6C";case 6:return"#6CFFCA";case 7:return"#69E4FF";case 8:return"#99A3FF";case 9:return"#C699FF";case 10:return"#FFA0EA";default:return"#5663BA"}}function G(e=""){return`<svg ${e} viewBox="0 0 400 283" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M396.063 200.058C387.286 177.198 388.232 171.375 363.69 113.777C342.879 64.745 324.486 39.1518 302.256 32.5827V16.449C302.256 7.35738 294.899 0 285.807 0H260.74C251.648 0 244.291 7.35738 244.291 16.449V30.7959H155.687V16.449C155.687 7.35738 148.277 0 139.238 0H114.17C105.079 0 97.7212 7.35738 97.7212 16.449V32.5827C75.4388 39.1518 57.098 64.745 36.2345 113.777C11.6925 171.427 12.5859 177.25 3.80958 200.058C-4.91416 222.919 0.341103 257.656 30.0859 275.104C59.8833 292.499 89.6806 279.36 114.17 246.568C138.712 213.775 148.329 215.414 169.35 215.414H230.679C251.701 215.414 261.265 213.775 285.807 246.568C310.297 279.36 340.094 292.446 369.891 275.104C399.636 257.709 404.944 222.919 396.168 200.058H396.063Z" />
    </svg>`}function A(e){return G(`class="bg-review-score" fill="${V(e)}"`)}function M(e,a){let t=a,s=$(".gas-list-entry-cover-game",t);return s?.length&&(t=w(s,e)||t),t}function u({listData:e,elemId:a,numKeysToReplace:t,textKeysToReplace:s,drillDown:r={key:null,keysToReplace:null}}){console.info(`=== ${a} results ===`,e);let n=$(a).prop("outerHTML"),m=$(`${a} .gas-list`),h=$(`${a} .gas-list-empty`),d=$(".gas-list-entry",m).first();d.show(),n=d.prop("outerHTML"),d.hide(),e?.length&&n?.length?(m.html(d),e.forEach((p,B)=>{let o=n;o=o.replaceAll("{|idx|}",B+1);for(let[l,c]of Object.entries(p)){if(p.gameIconURL?.length&&!f(p.gameIconURL)&&(o=M(p.gameIconURL,o)),(p.iconURL?.length||p.imageURL?.length)&&!T(p.imageURL)&&!f(p.imageURL)&&!f(p.iconURL)){let i=$(".gas-list-entry-cover",o);i?.length&&(o=a.includes("list-games")?i.css("background-image",`url(${p.imageURL})`).parents(".gas-list-entry").prop("outerHTML"):w(i,p.iconURL||p.imageURL)||o)}if(s.includes(l))o=o.replaceAll(`{|${l}|}`,(l.endsWith("At")?g(c):v(c))||"");else if(t.includes(l))o=o.replaceAll(`{|${l}|}`,Math.round(c||0));else if(l==="lastPlayed")o=o.replaceAll(`{|${l}|}`,g(c));else if(l==="content")o=o.replaceAll(`{|${l}|}`,C(c,160));else if(l==="importedFromPlatform"||l==="platform"||l==="platforms")o=x(c,o);else if(r.key&&l===r.key)for(let i of r.keysToReplace)i==="platform"?o=x(c[i],o):i==="gameIconURL"?o=M(c[i],o):typeof c[i]=="string"?o=o.replaceAll(`{|${i}|}`,c[i]):o=o.replaceAll(`{|${i}|}`,Math.round(c[i]||0));else if(l==="rating"){o=o.replaceAll(`{|${l}|}`,Math.round(c||0));let i=$(".gas-list-entry-rating",o);i.length&&(o=i.prepend(A(c)).parents(".gas-list-entry").prop("outerHTML"))}}m.append(o)})):(e?.length&&!n?.length&&console.error(`${a} template issue (missing a '.gas-' class?)`),$(a).html(h),h.show()),m.css("display","flex")}async function R(e,a){let t=await fetch(`https://${a}/api/achievement/list/latest`),s=[];t.ok&&(s=(await t.json()).slice(0,4));let r=`${e}-list-achievements-latest`;u({listData:s,elemId:r,numKeysToReplace:["id"],textKeysToReplace:[],drillDown:{key:"gameVersionData",keysToReplace:["completion","platform","totalAchievements","gameIconURL","name","description","gameIconURL"]}}),$(`${r} .ga-loader-container`).hide()}async function k(e,a,t){let s=await fetch(`https://${a}/api/game/list/${e}`),r=[];s.ok&&(r=(await s.json())?.slice(0,4));let n=`${t}-list-games-${e}`;u({listData:r,elemId:n,numKeysToReplace:["id","players","achievements","averageCompletion","totalAchievements"],textKeysToReplace:["id","name","description","lastPlayed","externalGameId"]}),$(`${n} .ga-loader-container`).hide()}async function F(e,a,t,s){let r=$(".gas-filters-sw-li.active",$(e)).first().text(),n=t.target.innerText.toLowerCase()==="next"?Number(r)+1:t.target.innerText.toLowerCase()==="previous"?Number(r)-1:Number(t.target.innerText);$(".gas-filters-sw-li",$(e)).removeClass("active").removeClass("disabled"),$(`#btn-page-${n}`,$(e)).addClass("active"),n===a?$("#btn-page-next",$(e)).addClass("disabled"):n===1&&$("#btn-page-previous",$(e)).addClass("disabled"),await s()}function H(e,a){let t=$(".gas-filters-sw-li.duplicate-btn",$(e));if(a===1){$("#btn-page-next").addClass("disabled");return}let s=a>6,r=s?6:a;for(let n=2;n<=r;n++)j(t,n,{place:"before",elementId:"#btn-page-next"}),s&&n===r&&(K(t,{place:"after",elementId:`#btn-page-${n}`}),O(t,{place:"before",elementId:"#btn-page-next"}))}function j(e,a,t={place:"before",elementId:"#btn-page-next"}){let s=e.clone();s.text(a).removeClass("duplicate-btn").attr("id",`btn-page-${a}`),t.place==="before"?s.insertBefore(t.elementId):s.insertAfter(t.elementId)}function K(e,a={place:"before",elementId:"#btn-page-next"}){let t=e.clone();t.text("...").removeClass("duplicate-btn").addClass("disabled").prop("disabled",!0),a.place==="before"?t.insertBefore(a.elementId):t.insertAfter(a.elementId)}function O(e,a={place:"before",elementId:"#btn-page-next"}){let t=e.clone();t.text(totalPages).removeClass("duplicate-btn"),a.place==="before"?t.insertBefore(a.elementId):t.insertAfter(a.elementId)}var L=1;function _(e,a){H(e,L),$(`${e} .gas-filters-sw-li`).on("click",t=>F("#gas-home-list-guides",L,t,()=>D(e,a)))}async function D(e,a){let t=$(`${e} .gas-filters-sw-li.active`).text()||1,s=4,r=await fetch(`https://${a}/api/guide/list?perPage=${s}&orderBy=createdAt:desc&offset=${t-1}`),n=[];if(r.ok){let m=await r.json();L=Math.ceil((m?.count||0)/s),n=m.results}u({listData:n,elemId:e,numKeysToReplace:["id","comments","likes"],textKeysToReplace:["name","author","description","profileId"]}),$(`${e} .ga-loader-container`).hide()}async function U(e,a){await D(`${e}-list-guides`,a),_(`${e}-list-guides`,a)}async function P(e){let t=await(await fetch(`https://${e}/api/game/stats`)).json(),s=$("#top-page"),r=s.prop("outerHTML");console.info("=== #top-page ===",t);let n=["registeredUsers","gamesTracked","achievementsTracked","achievementsUnlocked","forumPosts"];for(let[m,h]of Object.entries(t))n.find(d=>d.toLowerCase()===m.toLowerCase())&&(r=r.replaceAll(`{|${m}|}`,Math.round(h||0)));s.prop("outerHTML",r)}var N=document.querySelector("meta[name=forum-domain]")?.content;async function S(e){let a=await fetch(`https://${N}/api/recent`),t=[];a.ok&&(t=(await a.json()).topics.slice(0,5)),t=t.map(r=>({id:r.cid,title:r.title,topic_id:r.tid,author_name:r.user.username,imageURL:r.user.picture?.toLowerCase().includes("http")?new DOMParser().parseFromString(r.user.picture,"text/html").documentElement.textContent:"https://uploads-ssl.webflow.com/6455fdc10a7247f51c568c32/64b50ee999d75d5f75a28b08_user%20avatar%20default.svg",category_name:r.category.name,category_id:r.category.cid,views:r.viewcount,upvotes:r.upvotes,replies:r.postcount}));let s=`${e}-forum-threads`;u({listData:t,elemId:s,numKeysToReplace:["replies","views","upvotes"],textKeysToReplace:["title","author_name","category_name","topic_id","category_id"]}),$(`${s} .ga-loader-container`).hide()}var y=document.querySelector("meta[name=domain]")?.content,b="#gas-home";$(async()=>{$(".ga-loader-container").show(),await auth0Bootstrap(),await Promise.all(["recent","top"].map(async e=>await k(e,y,b)),await P(y),await U(b,y),await R(b,y),await S(b))});})();
