(()=>{var h=e=>{let t=r=>`0${r}`.slice(-2),a=new Date(e);return`${a.getFullYear()} . ${t(a.getMonth()+1)} . ${t(a.getDate())}`};var C=e=>e?.length?e.replace(/"(\w)/g,"\u201C$1").replace(/(\w)"/g,"$1\u201D").replaceAll('"',"'"):e;function b(e,t){if(e.length<=t)return e;let a=e.substr(0,t);return a=a.substr(0,Math.min(a.length,a.lastIndexOf(" "))),`${a} ...`}var f=e=>e?.includes("steamstatic")||e?.includes("steampowered"),T=e=>e?.includes("images-eds.xboxlive.com");var x=(e,t,a=".gas-list-entry")=>{let r=t,s={ps:{rgx:/playstation/gi},xbox:{rgx:/xbox/gi},steam:{rgx:/steam|pc|windows|mac|linux/gi}};return s.ps.rgx.test(e)&&(r=$(".gas-platform-psn",r).css("display","inherit").parents(a).prop("outerHTML")),s.steam.rgx.test(e)&&(r=$(".gas-platform-steam",r).css("display","inherit").parents(a).prop("outerHTML")),s.xbox.rgx.test(e)&&(r=$(".gas-platform-xbox",r).css("display","inherit").parents(a).prop("outerHTML")),r};var w=(e,t,a=".gas-list-entry")=>e.removeAttr("srcset").removeAttr("sizes").attr("src",t).parents(a).prop("outerHTML");function P(e){switch(e){case 1:return"#FF6C6C";case 2:return"#FF876C";case 3:return"#FFB36C";case 4:return"#FFD66C";case 5:return"#D0FF6C";case 6:return"#6CFFCA";case 7:return"#69E4FF";case 8:return"#99A3FF";case 9:return"#C699FF";case 10:return"#FFA0EA";default:return"#5663BA"}}function _(e=""){return`<svg ${e} viewBox="0 0 400 283" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M396.063 200.058C387.286 177.198 388.232 171.375 363.69 113.777C342.879 64.745 324.486 39.1518 302.256 32.5827V16.449C302.256 7.35738 294.899 0 285.807 0H260.74C251.648 0 244.291 7.35738 244.291 16.449V30.7959H155.687V16.449C155.687 7.35738 148.277 0 139.238 0H114.17C105.079 0 97.7212 7.35738 97.7212 16.449V32.5827C75.4388 39.1518 57.098 64.745 36.2345 113.777C11.6925 171.427 12.5859 177.25 3.80958 200.058C-4.91416 222.919 0.341103 257.656 30.0859 275.104C59.8833 292.499 89.6806 279.36 114.17 246.568C138.712 213.775 148.329 215.414 169.35 215.414H230.679C251.701 215.414 261.265 213.775 285.807 246.568C310.297 279.36 340.094 292.446 369.891 275.104C399.636 257.709 404.944 222.919 396.168 200.058H396.063Z" />
    </svg>`}function A(e){return _(`class="bg-review-score" fill="${P(e)}"`)}function k(e,t){let a=t,r=$(".gas-list-entry-cover-game",a);return r?.length&&(a=w(r,e)||a),a}function g({listData:e,elemId:t,numKeysToReplace:a,textKeysToReplace:r,drillDown:s={key:null,keysToReplace:null}}){console.info(`=== ${t} results ===`,e);let n=$(t).prop("outerHTML"),i=$(`${t} .gas-list`),u=$(`${t} .gas-list-empty`),c=$(".gas-list-entry",i).first();c.show(),n=c.prop("outerHTML"),c.hide(),e?.length&&n?.length?(i.html(c),e.forEach((l,K)=>{let o=n;o=o.replaceAll("{|idx|}",K+1);for(let[m,d]of Object.entries(l)){if(l.gameIconURL?.length&&!f(l.gameIconURL)&&(o=k(l.gameIconURL,o)),(l.iconURL?.length||l.imageURL?.length)&&!T(l.imageURL)&&!f(l.imageURL)&&!f(l.iconURL)){let p=$(".gas-list-entry-cover",o);p?.length&&(o=t.includes("list-games")?p.css("background-image",`url(${l.imageURL})`).parents(".gas-list-entry").prop("outerHTML"):w(p,l.iconURL||l.imageURL)||o)}if(r.includes(m))o=o.replaceAll(`{|${m}|}`,(m.endsWith("At")?h(d):C(d))||"");else if(a.includes(m))o=o.replaceAll(`{|${m}|}`,Math.round(d||0));else if(m==="lastPlayed")o=o.replaceAll(`{|${m}|}`,h(d));else if(m==="content")o=o.replaceAll(`{|${m}|}`,b(d,160));else if(m==="importedFromPlatform"||m==="platform"||m==="platforms")o=x(d,o);else if(s.key&&m===s.key)for(let p of s.keysToReplace)p==="platform"?o=x(d[p],o):p==="gameIconURL"?o=k(d[p],o):typeof d[p]=="string"?o=o.replaceAll(`{|${p}|}`,d[p]):o=o.replaceAll(`{|${p}|}`,Math.round(d[p]||0));else if(m==="rating"){o=o.replaceAll(`{|${m}|}`,Math.round(d||0));let p=$(".gas-list-entry-rating",o);p.length&&(o=p.prepend(A(d)).parents(".gas-list-entry").prop("outerHTML"))}}i.append(o)})):(e?.length&&!n?.length&&console.error(`${t} template issue (missing a '.gas-' class?)`),$(t).html(u),u.show()),i.css("display","flex")}async function H(e,t){let a=await fetch(`https://${t}/api/achievement/list/latest`),r=[];a.ok&&(r=(await a.json()).slice(0,4));let s=`${e}-list-achievements-latest`;g({listData:r,elemId:s,numKeysToReplace:["id"],textKeysToReplace:[],drillDown:{key:"gameVersionData",keysToReplace:["completion","platform","totalAchievements","gameIconURL","name","description","gameIconURL"]}}),$(`${s} .ga-loader-container`).hide()}async function F(e,t,a){let r=await fetch(`https://${t}/api/game/list/${e}`),s=[];r.ok&&(s=(await r.json())?.slice(0,4));let n=`${a}-list-games-${e}`;g({listData:s,elemId:n,numKeysToReplace:["id","players","achievements","averageCompletion","totalAchievements"],textKeysToReplace:["id","name","description","lastPlayed","externalGameId"]}),$(`${n} .ga-loader-container`).hide()}function D(e,t,a){let r=$(".gas-filters-sw-li.duplicate-btn",$(e));t===1&&$("#btn-page-next").addClass("disabled");let n=t>a?a-1:t;for(let i=1;i<=t;i++){let u=i>=n&&i!==t;N(r,i,u?"hidden":"",{place:"before",elementId:"#btn-page-next"}),i===t&&t>a&&L({place:"before",elementId:`#btn-page-${i}`})}r.remove()}function N(e,t,a,r={place:"before",elementId:"#btn-page-next"}){let s=e.clone();s.text(t).removeClass("duplicate-btn").addClass(`btn-page ${a??""}`).attr("id",`btn-page-${t}`),r.place==="before"?s.insertBefore(r.elementId):s.insertAfter(r.elementId)}function L(e={place:"before",elementId:"#btn-page-next"}){let t=$('<span class="btn-ellipsis">...</span>');e.place==="before"?t.insertBefore(e.elementId):t.insertAfter(e.elementId)}var S=1,M=5;function U(e,t){let a=t-M+1,r=e<=M-1,s=e>=a+1,n=-1;$(".btn-ellipsis").remove(),$(".gas-filters-sw").children(":not(#btn-page-previous):not(#btn-page-next)").each((i,u)=>{let c=i+1,l=$(u);c===1||c===t||r&&c<=M||s&&c>=a||c===e-S||c===e||c===e+S?l.removeClass("hidden"):(l.addClass("hidden"),(n===-1||!r&&!s&&$("span.btn-ellipsis").length<2&&c>e)&&(n=c,L({place:"after",elementId:u})))})}async function I(e,t,a,r){let s=$(".gas-filters-sw-li.active",$(e)).first().text(),n=a.target.innerText.toLowerCase()==="next"?Number(s)+1:a.target.innerText.toLowerCase()==="previous"?Number(s)-1:Number(a.target.innerText);$(".gas-filters-sw-li:not(.btn-ellipsis)",$(e)).removeClass("active").removeClass("disabled"),$(`#btn-page-${n}`,$(e)).addClass("active"),n===t?$("#btn-page-next",$(e)).addClass("disabled"):n===1&&$("#btn-page-previous",$(e)).addClass("disabled"),U(Number(n),t),await r()}var R=1,E=7;function X(e,t){D(e,R,E),$(`${e} .gas-filters-sw-li`).on("click",a=>I("#gas-home-list-guides",R,a,()=>B(e,t))),$("#btn-page-1").addClass("active")}async function B(e,t){let a=$(`${e} .gas-filters-sw-li.active`).text()||1,r=4,s=await fetch(`https://${t}/api/guide/list?perPage=${r}&orderBy=createdAt:desc&offset=${a-1}`),n=[];if(s.ok){let i=await s.json();R=Math.ceil((i?.count||0)/r),n=i.results}g({listData:n,elemId:e,numKeysToReplace:["id","comments","likes"],textKeysToReplace:["name","author","description","profileId"]}),$(`${e} .ga-loader-container`).hide()}async function V(e,t){await B(`${e}-list-guides`,t),X(`${e}-list-guides`,t)}async function G(e){let a=await(await fetch(`https://${e}/api/game/stats`)).json(),r=$("#top-page"),s=r.prop("outerHTML");console.info("=== #top-page ===",a);let n=["registeredUsers","gamesTracked","achievementsTracked","achievementsUnlocked","forumPosts"];for(let[i,u]of Object.entries(a))n.find(c=>c.toLowerCase()===i.toLowerCase())&&(s=s.replaceAll(`{|${i}|}`,Math.round(u||0)));r.prop("outerHTML",s)}var q=document.querySelector("meta[name=forum-domain]")?.content;async function j(e){let t=await fetch(`https://${q}/api/recent`),a=[];t.ok&&(a=(await t.json()).topics.slice(0,5)),a=a.map(s=>({id:s.cid,title:s.title,topic_id:s.tid,author_name:s.user.username,imageURL:s.user.picture?.toLowerCase().includes("http")?new DOMParser().parseFromString(s.user.picture,"text/html").documentElement.textContent:"https://uploads-ssl.webflow.com/6455fdc10a7247f51c568c32/64b50ee999d75d5f75a28b08_user%20avatar%20default.svg",category_name:s.category.name,category_id:s.category.cid,views:s.viewcount,upvotes:s.upvotes,replies:s.postcount}));let r=`${e}-forum-threads`;g({listData:a,elemId:r,numKeysToReplace:["replies","views","upvotes"],textKeysToReplace:["title","author_name","category_name","topic_id","category_id"]}),$(`${r} .ga-loader-container`).hide()}var y=document.querySelector("meta[name=domain]")?.content,v="#gas-home";$(async()=>{$(".ga-loader-container").show(),await auth0Bootstrap(),await Promise.all(["recent","top"].map(async e=>await F(e,y,v)),await G(y),await V(v,y),await H(v,y),await j(v))});})();
