(()=>{var m=t=>{let e=r=>`0${r}`.slice(-2),s=new Date(t);return`${s.getFullYear()} . ${e(s.getMonth()+1)} . ${e(s.getDate())}`};var g=t=>t?.length?t.replace(/"(\w)/g,"\u201C$1").replace(/(\w)"/g,"$1\u201D").replaceAll('"',"'"):t;var d=t=>t?.includes("steamstatic")||t?.includes("steampowered");var f=(t,e,s=".gas-list-entry")=>{let r=e,n={ps:{rgx:/playstation/gi},xbox:{rgx:/xbox/gi},steam:{rgx:/steam|pc|windows|mac|linux/gi}};return n.ps.rgx.test(t)&&(r=$(".gas-platform-psn",r).css("display","inherit").parents(s).prop("outerHTML")),n.steam.rgx.test(t)&&(r=$(".gas-platform-steam",r).css("display","inherit").parents(s).prop("outerHTML")),n.xbox.rgx.test(t)&&(r=$(".gas-platform-xbox",r).css("display","inherit").parents(s).prop("outerHTML")),r};var x=(t,e,s=".gas-list-entry")=>t.removeAttr("srcset").removeAttr("sizes").attr("src",e).parents(s).prop("outerHTML");var w=(t,e,s={})=>{$(`${t} form.search`).on("submit",async function(r){r.preventDefault(),searchTerm=new URLSearchParams($(this).serialize()).get("query"),searchTerm?.length&&($(".ga-loader-container",t).show(),$(".gas-list,.gas-list-results-info",t).hide(),await e(t,searchTerm,s),$(".gas-list-results-info",t).show(),$(".ga-loader-container").hide())})};var L=document.querySelector("meta[name=domain]")?.content,C,T,y;function F({listData:t,elemId:e,numKeysToReplace:s,textKeysToReplace:r}){console.info(`=== ${e} results ===`,t);let n=$(e).prop("outerHTML"),o=$(`${e} .gas-list`);C||(y=$(".gas-list-empty",o),T=o.children().first(),C=$(".gas-list-entry",o).first().clone(),$(".gas-list-entry",o).first().remove()),t.length>0?(n=C.prop("outerHTML"),o.html(T),t.forEach((h,b)=>{let a=n;for(let[i,l]of Object.entries(h)){let u=h.iconURL||h.imageURL;if(u?.length&&!d(u)){let c=$(".gas-list-entry-cover",a);c?.length&&(a=x(c,u)||a)}if(r.includes(i))a=a.replaceAll(`{|${i}|}`,(i.endsWith("At")?m(l):g(l))||"");else if(s.includes(i))a=a.replaceAll(`{|${i}|}`,Math.round(l||0));else if(i==="importedFromPlatform"||i==="platform")a=f(l,a);else if(i==="consoles"&&l?.length&&!l.includes("PC")){let c=$(`.gas-tags-${i}`,a);c?.length&&(a=c.html(l.map(v=>`<div class="console-tag" title="${v}"><div class="gas-text-overflow">${v}</div></div>`).join(`
`)).parents(".gas-list-entry").prop("outerHTML"))}}o.append(a).children().last().removeClass(["bg-light","bg-dark"]).addClass(`bg-${b%2>0?"light":"dark"}`)})):(o.html(y),y.show()),o.css("display","flex")}async function p(t,e=""){let s=$(".gas-filters-sw-li.active").first().text(),r={};s!=="All"&&(r.startsWith=s),e.length&&(r.q=e);let o=await(await fetch(`https://${L}/api/game/list${Object.keys(r)?.length?`?${new URLSearchParams(r).toString()}`:""}`)).json();$(`${t} .gas-list-results-info`).text(`${o?.length||0} result(s)`),F({listData:o,elemId:t,numKeysToReplace:["completion","achievementsCount"],textKeysToReplace:["id","name","description","updatedAt"]})}async function A(t,e){$(".gas-filters-sw-li",$(t)).removeClass("active"),$(e.target).addClass("active"),$(".ga-loader-container",$(t)).show(),$(".gas-list,.gas-list-results-info",t).hide(),await p(t),$(".gas-list-results-info",t).show(),$(".ga-loader-container").hide()}$(async()=>{await auth0Bootstrap();let t="#gas-list-games";$(`${t} .gas-filters-sw-li`).on("click",e=>A(t,e)),w(t,p),await p(t),$(".ga-loader-container").hide()});})();
