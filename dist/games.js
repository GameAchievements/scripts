(()=>{function k(t,e){let r=t-5+1,s=e<=4,a=e>=r+1;return t<=7?Array.from({length:t},(o,n)=>n+1):s?[...Array.from({length:5},(o,n)=>n+1),"ellipsis",t]:a?[1,"ellipsis",...Array.from({length:5},(o,n)=>t-n).sort()]:[1,"ellipsis",...Array.from({length:3},(o,n)=>e-1+n),"ellipsis",t]}function f(t,e,r=1){$(".gas-filters-sw-li.btn-page",$(t)).remove(),$(".btn-ellipsis",$(t)).remove();let s=$(".gas-filters-sw-li.duplicate-btn",$(t));e===1&&$("#btn-page-next").addClass("disabled");let a=k(e,r);for(let o of a)o==="ellipsis"?O():N(s,o)}function N(t,e,r,s={place:"before",elementId:"#btn-page-next"}){let a=t.clone();a.text(e).removeClass("duplicate-btn").addClass(`btn-page ${r??""}`).attr("id",`btn-page-${e}`),s.place==="before"?a.insertBefore(s.elementId):a.insertAfter(s.elementId)}function O(t={place:"before",elementId:"#btn-page-next"}){let e=$('<span class="btn-ellipsis">...</span>');t.place==="before"?e.insertBefore(t.elementId):e.insertAfter(t.elementId)}async function w(t,e,r,s){let a=$(".gas-filters-sw-li.active",$(t)).first().text(),o=r.target.innerText.toLowerCase()==="next"?Number(a)+1:r.target.innerText.toLowerCase()==="previous"?Number(a)-1:Number(r.target.innerText);$(".gas-filters-sw-li:not(.btn-ellipsis)",$(t)).removeClass("active").removeClass("disabled"),o===e?$("#btn-page-next",$(t)).addClass("disabled"):o===1&&$("#btn-page-previous",$(t)).addClass("disabled"),f(t,e,o),$(`#btn-page-${o}`,$(t)).addClass("active"),$(`${t} .btn-page`).on("click",n=>{w(t,e,n,()=>s())}),await s()}function h({elemId:t,fetchFn:e,totalPages:r}){$(`${t} .gas-filters-sw-li`).off("click"),f(t,r),$(`${t} .gas-filters-sw-li`).on("click",s=>{w(t,r,s,()=>e())}),$("#btn-page-1").addClass("active")}function F(t,e){let r=$(".gas-list-total-pages-info"),s=window.MutationObserver,a=new s(o);r.each(function(){a.observe(this,{childList:!0})});function o(n){for(let c of n)if(c.addedNodes.length>0){let i=Number(c.addedNodes[0].data);h({elemId:`${t}-pagination`,fetchFn:e,totalPages:i})}}}var d=t=>{let e=s=>`0${s}`.slice(-2),r=new Date(t);return`${r.getFullYear()} . ${e(r.getMonth()+1)} . ${e(r.getDate())}`};var b=t=>t?.length?t.replace(/"(\w)/g,"\u201C$1").replace(/(\w)"/g,"$1\u201D").replaceAll('"',"'"):t;var C=t=>t?.includes("steamstatic")||t?.includes("steampowered");var v=(t,e,r=".gas-list-entry")=>{let s=e,a={ps:{rgx:/playstation/gi},xbox:{rgx:/xbox/gi},steam:{rgx:/steam|pc|windows|mac|linux/gi}};return a.ps.rgx.test(t)&&(s=$(".gas-platform-psn",s).css("display","inherit").parents(r).prop("outerHTML")),a.steam.rgx.test(t)&&(s=$(".gas-platform-steam",s).css("display","inherit").parents(r).prop("outerHTML")),a.xbox.rgx.test(t)&&(s=$(".gas-platform-xbox",s).css("display","inherit").parents(r).prop("outerHTML")),s};var y=(t,e,r=".gas-list-entry")=>t.removeAttr("srcset").removeAttr("sizes").attr("src",e).parents(r).prop("outerHTML");var T=(t,e,r={})=>{$(`${t} .search-input`).removeAttr("required"),$(`${t} form.search`).on("submit",async function(s){s.preventDefault(),searchTerm=new URLSearchParams($(this).serialize()).get("query"),$(".ga-loader-container",t).show(),$(".gas-list,.gas-list-results-info",t).hide(),await e(t,searchTerm,r),$(".gas-list-results-info",t).show(),$(".ga-loader-container").hide()})};var A,H,M;function R({listData:t,elemId:e,numKeysToReplace:r,textKeysToReplace:s}){console.info(`=== ${e} results ===`,t);let a=$(e).prop("outerHTML"),o=$(`${e} .gas-list`);A||(M=$(".gas-list-empty",o),H=o.children().first(),A=$(".gas-list-entry",o).first().clone(),$(".gas-list-entry",o).first().remove()),t.length>0?(a=A.prop("outerHTML"),o.html(H),t.forEach((n,c)=>{let i=a;for(let[l,p]of Object.entries(n)){let x=n.iconURL||n.imageURL;if(x?.length&&!C(x)){let g=$(".gas-list-entry-cover",i);g?.length&&(i=y(g,x)||i)}if(s.includes(l))i=i.replaceAll(`{|${l}|}`,(l.endsWith("At")?d(p):b(p))||"");else if(r.includes(l))i=i.replaceAll(`{|${l}|}`,Math.round(p||0));else if(l==="importedFromPlatform"||l==="platform")i=v(p,i);else if(l==="consoles"&&p?.length&&!p.includes("PC")){let g=$(`.gas-tags-${l}`,i);g?.length&&(i=g.html(p.map(L=>`<div class="console-tag" title="${L}"><div class="gas-text-overflow">${L}</div></div>`).join(`
`)).parents(".gas-list-entry").prop("outerHTML"))}}o.append(i).children().last().removeClass(["bg-light","bg-dark"]).addClass(`bg-${c%2>0?"light":"dark"}`)})):(o.html(M),M.show()),o.css("display","flex")}var u=1,S=20,U=document.querySelector("meta[name=domain]")?.content;async function m(t,e=""){let r=$(`${t}-pagination .gas-filters-sw-li.active`).text()||1,s=$(`${t} .gas-filters-sw-li.active`).first().text(),a={};s!=="All"&&(a.startsWith=s),e.length&&(a.q=e);let o=`https://${U}/api/game/list?perPage=${S}&offset=${r-1}${Object.keys(a)?.length?`&${new URLSearchParams(a).toString()}`:""}`,n=await fetch(o),c=[],i=u;if(n.ok){let l=await n.json();u=Math.ceil((l?.count||1)/S),c=l.results}$(`${t} .gas-list-results-info`).text(`${c?.length||0} result(s)`),i!==u&&$(`${t} .gas-list-total-pages-info`).text(u),R({listData:c,elemId:t,numKeysToReplace:["completion","achievementsCount"],textKeysToReplace:["id","name","description","updatedAt"]})}async function D(t){await m(t),h({elemId:`${t}-pagination`,fetchFn:()=>m(t),totalPages:u}),F(t,()=>m(t))}async function B(t,e){$(".gas-filters-sw-li",$(t)).filter(function(){return $(this).parents(`${t}-pagination`).length===0}).removeClass("active"),$(e.target).addClass("active"),$(".ga-loader-container",$(t)).show(),$(".gas-list,.gas-list-results-info",t).hide(),await m(t),$(".gas-list-results-info",t).show(),$(".ga-loader-container").hide()}$(async()=>{await auth0Bootstrap();let t="#gas-list-games";$(`${t} .gas-filters-sw-li`).filter(function(){return $(this).parents(`${t}-pagination`).length===0}).on("click",e=>B(t,e)),T(t,m),await D(t),$(".ga-loader-container").hide()});})();
