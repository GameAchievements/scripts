(()=>{function F(t,e,s){$(".gas-filters-sw-li.btn-page",$(t)).remove(),$(".btn-ellipsis",$(t)).remove();let r=$(".gas-filters-sw-li.duplicate-btn",$(t));e===1&&$("#btn-page-next").addClass("disabled");let n=e>s?s-1:e;for(let l=1;l<=e;l++){let p=l>=n&&l!==e;U(r,l,p?"hidden":"",{place:"before",elementId:"#btn-page-next"}),l===e&&e>s&&x({place:"before",elementId:`#btn-page-${l}`})}}function U(t,e,s,r={place:"before",elementId:"#btn-page-next"}){let a=t.clone();a.text(e).removeClass("duplicate-btn").addClass(`btn-page ${s??""}`).attr("id",`btn-page-${e}`),r.place==="before"?a.insertBefore(r.elementId):a.insertAfter(r.elementId)}function x(t={place:"before",elementId:"#btn-page-next"}){let e=$('<span class="btn-ellipsis">...</span>');t.place==="before"?e.insertBefore(t.elementId):e.insertAfter(t.elementId)}var H=1,w=5;function k(t,e,s){let r=e-w+1,a=t<=w-1,n=t>=r+1,l=-1;$(".btn-ellipsis",$(s)).remove(),$(".gas-filters-sw",$(s)).children(":not(#btn-page-previous):not(#btn-page-next):not(.duplicate-btn)").each((p,i)=>{let o=p+1,c=$(i);o===1||o===e||a&&o<=w||n&&o>=r||o===t-H||o===t||o===t+H?c.removeClass("hidden"):(c.addClass("hidden"),(l===-1||!a&&!n&&$("span.btn-ellipsis",s).length<2&&o>t)&&(l=o,x({place:"after",elementId:i})))})}async function S(t,e,s,r){let a=$(".gas-filters-sw-li.active",$(t)).first().text(),n=s.target.innerText.toLowerCase()==="next"?Number(a)+1:s.target.innerText.toLowerCase()==="previous"?Number(a)-1:Number(s.target.innerText);$(".gas-filters-sw-li:not(.btn-ellipsis)",$(t)).removeClass("active").removeClass("disabled"),$(`#btn-page-${n}`,$(t)).addClass("active"),n===e?$("#btn-page-next",$(t)).addClass("disabled"):n===1&&$("#btn-page-previous",$(t)).addClass("disabled"),k(Number(n),e,t),await r()}function d({elemId:t,fetchFn:e,pageBreakpoint:s,totalPages:r}){$(`${t} .gas-filters-sw-li`).off("click"),F(t,r,s),$(`${t} .gas-filters-sw-li`).on("click",a=>{S(t,r,a,()=>e())}),$("#btn-page-1").addClass("active")}function D(t,e,s){let r=$(".gas-list-total-pages-info"),a=window.MutationObserver,n=new a(l);r.each(function(){n.observe(this,{childList:!0})});function l(p){for(let i of p)if(i.addedNodes.length>0){let o=Number(i.addedNodes[0].data);d({elemId:`${t}-pagination`,fetchFn:e,pageBreakpoint:s,totalPages:o})}}}var f=t=>{let e=r=>`0${r}`.slice(-2),s=new Date(t);return`${s.getFullYear()} . ${e(s.getMonth()+1)} . ${e(s.getDate())}`};var b=t=>t?.length?t.replace(/"(\w)/g,"\u201C$1").replace(/(\w)"/g,"$1\u201D").replaceAll('"',"'"):t;var C=t=>t?.includes("steamstatic")||t?.includes("steampowered");var v=(t,e,s=".gas-list-entry")=>{let r=e,a={ps:{rgx:/playstation/gi},xbox:{rgx:/xbox/gi},steam:{rgx:/steam|pc|windows|mac|linux/gi}};return a.ps.rgx.test(t)&&(r=$(".gas-platform-psn",r).css("display","inherit").parents(s).prop("outerHTML")),a.steam.rgx.test(t)&&(r=$(".gas-platform-steam",r).css("display","inherit").parents(s).prop("outerHTML")),a.xbox.rgx.test(t)&&(r=$(".gas-platform-xbox",r).css("display","inherit").parents(s).prop("outerHTML")),r};var y=(t,e,s=".gas-list-entry")=>t.removeAttr("srcset").removeAttr("sizes").attr("src",e).parents(s).prop("outerHTML");var T=(t,e,s={})=>{$(`${t} .search-input`).removeAttr("required"),$(`${t} form.search`).on("submit",async function(r){r.preventDefault(),searchTerm=new URLSearchParams($(this).serialize()).get("query"),$(".ga-loader-container",t).show(),$(".gas-list,.gas-list-results-info",t).hide(),await e(t,searchTerm,s),$(".gas-list-results-info",t).show(),$(".ga-loader-container").hide()})};var A,R,M;function B({listData:t,elemId:e,numKeysToReplace:s,textKeysToReplace:r}){console.info(`=== ${e} results ===`,t);let a=$(e).prop("outerHTML"),n=$(`${e} .gas-list`);A||(M=$(".gas-list-empty",n),R=n.children().first(),A=$(".gas-list-entry",n).first().clone(),$(".gas-list-entry",n).first().remove()),t.length>0?(a=A.prop("outerHTML"),n.html(R),t.forEach((l,p)=>{let i=a;for(let[o,c]of Object.entries(l)){let h=l.iconURL||l.imageURL;if(h?.length&&!C(h)){let g=$(".gas-list-entry-cover",i);g?.length&&(i=y(g,h)||i)}if(r.includes(o))i=i.replaceAll(`{|${o}|}`,(o.endsWith("At")?f(c):b(c))||"");else if(s.includes(o))i=i.replaceAll(`{|${o}|}`,Math.round(c||0));else if(o==="importedFromPlatform"||o==="platform")i=v(c,i);else if(o==="consoles"&&c?.length&&!c.includes("PC")){let g=$(`.gas-tags-${o}`,i);g?.length&&(i=g.html(c.map(L=>`<div class="console-tag" title="${L}"><div class="gas-text-overflow">${L}</div></div>`).join(`
`)).parents(".gas-list-entry").prop("outerHTML"))}}n.append(i).children().last().removeClass(["bg-light","bg-dark"]).addClass(`bg-${p%2>0?"light":"dark"}`)})):(n.html(M),M.show()),n.css("display","flex")}var u=1,O=7,N=20,j=document.querySelector("meta[name=domain]")?.content;async function m(t,e=""){let s=$(`${t}-pagination .gas-filters-sw-li.active`).text()||1,r=$(`${t} .gas-filters-sw-li.active`).first().text(),a={};r!=="All"&&(a.startsWith=r),e.length&&(a.q=e);let n=`https://${j}/api/game/list?perPage=${N}&offset=${s-1}${Object.keys(a)?.length?`&${new URLSearchParams(a).toString()}`:""}`,l=await fetch(n),p=[],i=u;if(l.ok){let o=await l.json();u=Math.ceil((o?.count||1)/N),p=o.results}$(`${t} .gas-list-results-info`).text(`${p?.length||0} result(s)`),i!==u&&$(`${t} .gas-list-total-pages-info`).text(u),B({listData:p,elemId:t,numKeysToReplace:["completion","achievementsCount"],textKeysToReplace:["id","name","description","updatedAt"]})}async function V(t){await m(t),d({elemId:`${t}-pagination`,fetchFn:()=>m(t),pageBreakpoint:O,totalPages:u}),D(t,()=>m(t),O)}async function P(t,e){$(".gas-filters-sw-li",$(t)).filter(function(){return $(this).parents(`${t}-pagination`).length===0}).removeClass("active"),$(e.target).addClass("active"),$(".ga-loader-container",$(t)).show(),$(".gas-list,.gas-list-results-info",t).hide(),await m(t),$(".gas-list-results-info",t).show(),$(".ga-loader-container").hide()}$(async()=>{await auth0Bootstrap();let t="#gas-list-games";$(`${t} .gas-filters-sw-li`).filter(function(){return $(this).parents(`${t}-pagination`).length===0}).on("click",e=>P(t,e)),T(t,m),await V(t),$(".ga-loader-container").hide()});})();
